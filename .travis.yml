# system information
os: linux
dist: trusty
sudo: require
language: cpp

# notification settings
notifications:
  slack:
    rooms:
      - crystal-code:JqFo74Bh13mTda4fbkf0xyGW#cpp
    on_success: change
    on_failure: always
  email:
    recipients:
      - dasayan05@hotmail.com
    on_success: change
    on_failure: always

matrix:
  include:
      - compiler: g++-5
        addons:
          apt:
            packages:
             - g++-5
            sources:
             - ubuntu-toolchain-r-test
        env:
         - MATRIX_ENV_CXX="CXX=g++-5"

      - compiler: g++-6
        addons:
          apt:
            packages:
             - g++-6
            sources:
             - ubuntu-toolchain-r-test
        env:
         - MATRIX_ENV_CXX="CXX=g++-6"

      - compiler: g++-7
        addons:
          apt:
            packages:
             - g++-7
            sources:
             - ubuntu-toolchain-r-test
        env:
         - MATRIX_ENV_CXX="CXX=g++-7"

      # - compiler: clang++-5.0
      #   addons:
      #     apt:
      #       packages:
      #        - clang++-5.0
      #        - clang-5.0
      #       sources:
      #        - llvm-toolchain-trusty-5.0
      #        - 
      #           sourceline: 'deb http://apt.llvm.org/trusty/ llvm-toolchain-trusty-5.0 main'
      #           key_url: 'https://apt.llvm.org/llvm-snapshot.gpg.key'
      #   env:
      #    - MATRIX_ENV_CXX="CC=clang-5.0 CXX=clang++-5.0"

before_script:
    - eval "${MATRIX_ENV_CXX}"
    
    # setup GoogleTest
    - sudo apt-get -qq update
    - sudo apt-get install -y cmake libblas-dev liblapack-dev gfortran
    - sudo wget https://github.com/google/googletest/archive/release-1.8.0.tar.gz
    - sudo tar xf release-1.8.0.tar.gz
    - cd googletest-release-1.8.0/googletest
    - sudo ../travis.sh
    - sudo make install
    - cd ..
    
    # create build directory for CMake
    # generation and cd into it
    - mkdir build
    - cd build

script:
    - cmake ..
    - make
    - ctest
